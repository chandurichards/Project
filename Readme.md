# Analysing Financial Statistics of P2P Lending Decision Platform

**Data Scientist internship work at Technocolabs Softwares.**


Deployed Web App: https://model-deployment-c4be.onrender.com 
# Project Summary
The main purposes of this analysis are to summarize the characteristics of variables that can affect the loan status and to get some ideas about the relationships among variables.

## Abstract

This project focuses on credit risk modeling for a peer-to-peer lending platform called Bondora. The data used for the study consists of both defaulted and non-defaulted loans collected from Bondora between March 1, 2009, and January 27, 2020. The dataset includes borrowers' demographic and financial information, as well as loan transaction details.

Peer-to-peer lending involves loans that are typically not backed by collateral, and lenders aim to earn higher returns to compensate for the financial risk they undertake. Lenders face information asymmetry, where borrowers have more information about their creditworthiness than the lenders. To make informed decisions, lenders aim to minimize the risk of default for each loan and achieve returns that adequately compensate for the risk involved.

## About the dataset
The dataset is of shape (134529,112) i.e., with 134529 rows and 112 columns. Here is the detailed description of all the columns of the dataset. 
| Feature                                | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|----------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ActiveLateCategory                     | When a loan is in Principal Debt then it will be categorized by Principal Debt days                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ActiveLateLastPaymentCategory          | Shows how many days has passed since last payment and categorised if it is overdue                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| ActiveScheduleFirstPaymentReached      | Whether the first payment date has been reached according to the active schedule                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Age                                    | The age of the borrower when signing the loan application                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Amount                                 | Amount the borrower received on the Primary Market. This is the principal balance of your purchase from Secondary Market                                                                                                                                                                                                                                                                                                                                                                                            |
| AmountOfPreviousLoansBeforeLoan        | Value of previous loans                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| AppliedAmount                          | The amount borrower applied for originally                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| AuctionBidNumber                       | Unique bid number which is accompanied by Auction number                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| AuctionId                              | A unique number given to all auctions                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| AuctionName                            | Name of the Auction, in newer loans it is defined by the purpose of the loan                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| AuctionNumber                          | Unique auction number which is accompanied by Bid number                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| BidPrincipal                           | On Primary Market BidPrincipal is the amount you made your bid on. On Secondary Market BidPrincipal is the purchase price                                                                                                                                                                                                                                                                                                                                                                                           |
| BidsApi                                | The amount of investment offers made via Api                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| BidsManual                             | The amount of investment offers made manually                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| BidsPortfolioManager                   | The amount of investment offers made by Portfolio Managers                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| BoughtFromResale_Date                  | The time when the investment was purchased from the Secondary Market                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| City                                   | City of the borrower                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ContractEndDate                        | The date when the loan contract ended                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Country                                | Residency of the borrower                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| County                                 | County of the borrower                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| CreditScoreEeMini                      | 1000 No previous payments problems 900 Payments problems finished 24-36 months ago 800 Payments problems finished 12-24 months ago 700 Payments problems finished 6-12 months ago 600 Payment problems finished < 6 months ago 500 Active payment problems                                                                                                                                                                                                                                                          |
| CreditScoreEsEquifaxRisk               | Generic score for the loan applicants that do not have active past due operations in ASNEF; a measure of the probability of default one year ahead; the score is given on a 6-grade scale: AAA (“Very low”), AA (“Low”), A (“Average”), B (“Average High”), C (“High”), D (“Very High”).                                                                                                                                                                                                                            |
| CreditScoreEsMicroL                    | A score that is specifically designed for risk classifying subprime borrowers (defined by Equifax as borrowers that do not have access to bank loans); a measure of the probability of default one month ahead; the score is given on a 10-grade scale, from the best score to the worst: M1, M2, M3, M4, M5, M6, M7, M8, M9, M10.                                                                                                                                                                                  |
| CreditScoreFiAsiakasTietoRiskGrade     | Credit Scoring model for Finnish Asiakastieto RL1 Very low risk 01-20 RL2 Low risk 21-40 RL3 Average risk 41-60 RL4 Big risk 61-80 RL5 Huge risk 81-100                                                                                                                                                                                                                                                                                                                                                             |
| CurrentDebtDaysPrimary                 | How long the loan has been in Principal Debt                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| CurrentDebtDaysSecondary               | How long the loan has been in Interest Debt                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| DateOfBirth                            | The date of the borrower's birth                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| DebtOccuredOn                          | The date when Principal Debt occurred                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| DebtOccuredOnForSecondary              | The date when Interest Debt occurred                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| DebtToIncome                           | Ratio of borrower's monthly gross income that goes toward paying loans                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| DefaultDate                            | The date when loan went into defaulted state and collection process was started                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| DesiredDiscountRate                    | Investment being sold at a discount or premium                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| EAD1                                   | Exposure at default, outstanding principal at default                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| EAD2                                   | Exposure at default, loan amount less all payments prior to default                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Education                              | 1 Primary education 2 Basic education 3 Vocational education 4 Secondary education 5 Higher education                                                                                                                                                                                                                                                                                                                                                                                                               |
| EL_V0                                  | Expected loss calculated by the specified version of Rating model                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| EL_V1                                  | Expected loss calculated by the specified version of Rating model                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| EL_V2                                  | Expected loss calculated by the specified version of Rating model                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| EmploymentDurationCurrentEmployer      | Employment time with the current employer                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| EmploymentPosition                     | Employment position with the current employer                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| EmploymentStatus                       | 1 Unemployed 2 Partially employed 3 Fully employed 4 Self-employed 5 Entrepreneur 6 Retiree                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ExistingLiabilities                    | Borrower's number of existing liabilities                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ExpectedLoss                           | Expected Loss calculated by the current Rating model                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ExpectedReturn                         | Expected Return calculated by the current Rating model                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| FirstPaymentDate                       | First payment date according to initial loan schedule                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| FreeCash                               | Discretionary income after monthly liabilities                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Gender                                 | 0 Male 1 Woman 2 Undefined                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| GracePeriodEnd                         | Date of the end of Grace period                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| GracePeriodStart                       | Date of the beginning of Grace period                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| HomeOwnershipType                      | 0 Homeless 1 Owner 2 Living with parents 3 Tenant, pre-furnished property 4 Tenant, unfurnished property 5 Council house 6 Joint tenant 7 Joint ownership 8 Mortgage 9 Owner with encumbrance 10 Other                                                                                                                                                                                                                                                                                                              |
| IncomeFromChildSupport                 | Borrower's income from alimony payments                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| IncomeFromFamilyAllowance              | Borrower's income from child support                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| IncomeFromLeavePay                     | Borrower's income from paternity leave                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| IncomeFromPension                      | Borrower's income from pension                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| IncomeFromPrincipalEmployer            | Borrower's income from its employer                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| IncomeFromSocialWelfare                | Borrower's income from social support                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| IncomeOther                            | Borrower's income from other sources                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| IncomeTotal                            | Borrower's total income                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Interest                               | Maximum interest rate accepted in the loan application                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| InterestAndPenaltyBalance              | Unpaid interest and penalties                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| InterestAndPenaltyDebtServicingCost    | Service cost related to the recovery of the debt based on the interest and penalties of the investment                                                                                                                                                                                                                                                                                                                                                                                                              |
| InterestAndPenaltyPaymentsMade         | Note owner received loan transfers earned interest, penalties total amount                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| InterestAndPenaltyWriteOffs            | Interest that was written off on the investment                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| InterestLateAmount                     | Interest debt amount                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| InterestRecovery                       | Interest recovered due to collection process from in debt loans                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| LanguageCode                           | 1 Estonian 2 English 3 Russian 4 Finnish 5 German 6 Spanish 9 Slovakian                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| LastPaymentOn                          | The date of the current last payment received from the borrower                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| LiabilitiesTotal                       | Total monthly liabilities                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| ListedOnUTC                            | Date when the loan application appeared on Primary Market                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| LoanDate                               | Date when the loan was issued                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| LoanDuration                           | Current loan duration in months                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| LoanId                                 | A unique ID given to all loan applications                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| LoanNumber                             | A unique number given to all loan applications                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| LoanStatusActiveFrom                   | How long the current status has been active                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| LossGivenDefault                       | Gives the percentage of outstanding exposure at the time of default that an investor is likely to lose if a loan actually defaults. This means the proportion of funds lost for the investor after all expected recovery and accounting for the time value of the money recovered. In general, LGD parameter is intended to be estimated based on the historical recoveries. However, in new markets where limited experience does not allow us more precise loss given default estimates, a LGD of 90% is assumed. |
| MaritalStatus                          | 1 Married 2 Cohabitant 3 Single 4 Divorced 5 Widow                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| MaturityDate_Last                      | Loan maturity date according to the current payment schedule                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| MaturityDate_Original                  | Loan maturity date according to the original loan schedule                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ModelVersion                           | The version of the Rating model used for issuing the Bondora Rating                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| MonthlyPayment                         | Estimated amount the borrower has to pay every month                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| MonthlyPaymentDay                      | The day of the month the loan payments are scheduled for The actual date is adjusted for weekends and bank holidays (e.g. if 10th is Sunday then the payment will be made on the 11th in that month)                                                                                                                                                                                                                                                                                                                |
| NewCreditCustomer                      | Did the customer have prior credit history in Bondora 0 Customer had at least 3 months of credit history in Bondora 1 No prior credit history in Bondora                                                                                                                                                                                                                                                                                                                                                            |
| NextPaymentDate                        | According to schedule the next date for borrower to make their payment                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| NextPaymentNr                          | According to schedule the number of the next payment                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| NextPaymentSum                         | According to schedule the amount of the next payment                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| NoOfPreviousLoansBeforeLoan            | Number of previous loans                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| note_id                                | A unique ID given to the investments                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| NoteLoanLateChargesPaid                | The amount of late charges the note has received                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| NoteLoanTransfersInterestAmount        | The amount of interest the note has received                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| NoteLoanTransfersMainAmount            | The amount of principal the note has received                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| NrOfDependants                         | Number of children or other dependants                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| NrOfScheduledPayments                  | According to schedule the count of scheduled payments                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| OccupationArea                         | 1 Other 2 Mining 3 Processing 4 Energy 5 Utilities 6 Construction 7 Retail and wholesale 8 Transport and warehousing 9 Hospitality and catering 10 Info and telecom 11 Finance and insurance 12 Real-estate 13 Research 14 Administrative 15 Civil service & military 16 Education 17 Healthcare and social help 18 Art and entertainment 19 Agriculture, forestry and fishing                                                                                                                                      |
| OnSaleSince                            | Time when the investment was added to Secondary Market                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| PenaltyLateAmount                      | Late charges debt amount                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| PlannedInterestPostDefault             | The amount of interest that was planned to be received after the default occurred                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| PlannedInterestTillDate                | According to active schedule the amount of interest the investment should have received                                                                                                                                                                                                                                                                                                                                                                                                                             |
| PlannedPrincipalPostDefault            | The amount of principal that was planned to be received after the default occurred                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| PlannedPrincipalTillDate               | According to active schedule the amount of principal the investment should have received                                                                                                                                                                                                                                                                                                                                                                                                                            |
| PreviousEarlyRepaymentsBeforeLoan      | How much was the early repayment amount before the loan                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| PreviousEarlyRepaymentsCountBeforeLoan | How many times the borrower had repaid early                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| PreviousRepaymentsBeforeLoan           | How much the borrower had repaid before the loan                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| PrincipalBalance                       | Principal that still needs to be paid by the borrower                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PrincipalDebtServicingCost             | Service cost related to the recovery of the debt based on the principal of the investment                                                                                                                                                                                                                                                                                                                                                                                                                           |
| PrincipalLateAmount                    | Principal debt amount                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| PrincipalOverdueBySchedule             | According to the current schedule, principal that is overdue                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| PrincipalPaymentsMade                  | Note owner received loan transfers principal amount                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| PrincipalRecovery                      | Principal recovered due to collection process from in debt loans                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| PrincipalWriteOffs                     | Principal that was written off on the investment                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ProbabilityOfDefault                   | Probability of Default, refers to a loan’s probability of default within one year horizon.                                                                                                                                                                                                                                                                                                                                                                                                                          |
| PurchasePrice                          | Investment amount or secondary market purchase price                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Rating                                 | Bondora Rating issued by the Rating model                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Rating_V0                              | Bondora Rating issued by version 0 of the Rating model                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Rating_V1                              | Bondora Rating issued by version 1 of the Rating model                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Rating_V2                              | Bondora Rating issued by version 2 of the Rating model                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| RecoveryStage                          | Current stage according to the recovery model 1 Collection 2 Recovery 3 Write Off                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| RefinanceLiabilities                   | The total amount of liabilities after refinancing                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| ReScheduledOn                          | The date when the a new schedule was assigned to the borrower                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Restructured                           | The original maturity date of the loan has been increased by more than 60 days                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| SoldInResale_Date                      | The date when the investment was sold on Secondary market                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| SoldInResale_Price                     | The price of the investment that was sold on Secondary market                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| SoldInResale_Principal                 | The principal remaining of the investment that was sold on Secondary market                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| StageActiveSince                       | How long the current recovery stage has been active                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Status                                 | The current status of the loan application                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| UseOfLoan                              | 0 Loan consolidation 1 Real estate 2 Home improvement 3 Business 4 Education 5 Travel 6 Vehicle 7 Other 8 Health 101 Working capital financing 102 Purchase of machinery equipment 103 Renovation of real estate 104 Accounts receivable financing 105 Acquisition of means of transport 106 Construction finance 107 Acquisition of stocks 108 Acquisition of real estate 109 Guaranteeing obligation 110 Other business All codes in format 1XX are for business loans that are not supported since October 2012  |
| UserName                               | The user name generated by the system for the borrower                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| VerificationType                       | Method used for loan application data verification 0 Not set 1 Income unverified 2 Income unverified, cross-referenced by phone 3 Income verified 4 Income and expenses verified                                                                                                                                                                                                                                                                                                                                    |
| WorkExperience                         | Borrower's overall work experience in years                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| WorseLateCategory                      | Displays the last longest period of days when the loan was in Principal Debt                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| XIRR                                   | XIRR (extended internal rate of return) is a methodology to calculate the net return using the loan issued date and amount, loan repayment dates and amounts and the principal balance according to the original repayment date. All overdue principal payments are written off immediately. No provisions for future losses are made & only received (not accrued or scheduled) interest payments are taken into account.                                                                                          |


## The steps involved in this data analysis are

 - [Data preprocessing](#data-preprocessing)
 - [Exploratory Data Analysis](#exploratory-data-analysis)
 - [Feature Engineering](#feature-engineering)
 - [Classification Modelling](#classification-modelling)
 - [Regression Modelling](#regression-modelling)
 - [Pipelining](#pipelining)
 - [Deployment](#deployment)

## Data Preprocessing

 - As we know, the size of the dataset is very large. We may not require all the columns that are present in the dataset. 
 - Percentage of **missing values** is calculated for each and every column to analyze the columns with null values. Features with more than 40% missing values were removed. Before removing, observe the columns if we can have any important columns in that. I observed that DefaultDate column is important in order to observe the defaulters and to create our target variable. Rest of the columns were removed and we are left with 77 columns now.
 - **Removing unwanted columns** is also necessary. For example, there may be some columns whose information can be given by other columns like we don't need Date of birth when we know the Age(For analysis purpose). Similarly the other columns. Finally we are left with 48 columns. 
 - To **create the Target variable**, analyze the Status column having 3 type of attributes(Current, Late, Repaid). Drop out the current column and examine defaulters and non defaulters using the DefaultDate given. If the particular borrower has default date then the loan is defaulted(1) otherwise non defaulted(0). This is our new target column after *Binary encoding*
 - Observe the data type of all the features. There are few data type mismatches. Change the data type of the features according to the [description](#about-the-dataset) of the features given. Convert these into *categorical features.*
 - Drop the DefaultDate and Status columns. We no more need them. Also, drop the features related to date. Save the initial preprocessed dataset and the size of the dataset is **77394 rows x 43 columns.**

## Exploratory Data Analysis
The exploratory data analysis (EDA) conducted on the dataset from the Bondora peer-to-peer lending platform revealed insights about the demographic and financial information of borrowers, as well as loan transactions. By examining the data, patterns, trends, and relationships were identified to gain a better understanding of the dataset. The EDA helped in uncovering important factors that may influence credit risk, such as the borrowers' characteristics and loan attributes. This analysis provided a foundation for further analysis and modeling in the credit risk assessment of the peer-to-peer lending platform.
 * Handle null values by replacing them with mean and mode. 
 ![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/f4b41bca-d8c5-413c-ab43-494e526d1c3f)

 
 * County and CreditScoreEsMicroL columns were dropped as we don't need information of County when we have the city and country of the borrower. CreditScoreEsMicrol have more missing values hence it is also dropped. 
 * Univariate and Bivariate analysis were performed. 
 * ## Univariate Analysis
	  -  Identified the outliers. We can see there are lot of outliers present where LoanDuration, MonthlyPaymentDay, are outlier free. There are very few outliers present in columns Age and LiabilitiesTotal.
 
	  ![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/b6e6b649-a29e-4b42-8156-febb627cd47b)

	  ![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/2f31067b-8bb8-417b-97b5-372ac3765c12)

	  
	  ![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/741d54f7-def5-4c83-aeb7-6137b2d47e59)
	  ![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/150a447a-efd1-4fb3-9cf7-ac5f030f841b)

	  As we can see, there are also borrowers of low age(0-2) and there are very few outliers for age column. These outliers must be of those 0-2 age.
   
	  ![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/b316ec0e-0a4f-489d-bbd7-e7de9f28c1c7)

	  - Countplots of all categorical columns were plotted and we can observe that there are some columns with high not specified/not set data. 
		  - UseOfLoan
		  - MaritalStatus
		  - EmploymentStatus
		  - OccupationArea
		  While HomeOwnershipType, Education and VerificationType have few Not set data and the remaining columns are completely defined.

	 ![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/217c386f-c466-4759-a912-ab5a1a1153a6)

	 ![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/4056056e-ca2d-44a8-8147-cc9a0f83b15d)

	 ![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/c3ed0926-5554-4cba-b300-2d34319b7bda)

	 ![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/b9c8b867-81e7-4689-adf9-66a75b09c7a4)

	 ![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/3cbe5c2c-baec-423b-bd68-c1d9ce39dcf3)

	 ![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/4a0bea61-f549-4a5e-b8f2-d9dd87ea740d)

	 ![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/12bdcb84-bea6-4123-bfab-2de1f81ced9e)

	 ![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/935fb722-1987-4928-9524-bb1ff7748710)

	 ![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/71856055-8a12-4e43-b280-321ad31f78ab)

	 ![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/f3e7ab53-1dd9-45fb-bc3c-123f19a400f7)

	 ![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/06d6d9bc-206e-4521-b98b-b01033214126)

	 ![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/b900c0e6-46b6-401e-8a30-bf86b6eeb933)

         
	- From the boolean features
		-   More than 63% customers have no prior credit history in Bondora
		*NewCreditCustomer*
		![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/d4f1622b-10cd-4d30-be28-5834c9e34c1e)

		-   The original maturity date has been increased by more than 60 days only for 20% of the loans
		*Restructured*
		![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/ce84242f-7b02-4e02-b4ff-1ee750225510)

- ## Bivariate Analysis
	- There are **42794** *default borrowers* and **34600** *non default borrowers*. Let's observe the correlated features.
   
	![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/48ab02d3-c521-48d7-b270-d49226785545)

	- From the correlation matrix, 
	![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/6ba7e550-57dc-4c3b-b1da-bd82803468ea)

		-   Target variable is highly negatively correlated with PrincipalPaymentsMade
		-  Target variable is positively correlated with InterestAndPenaltyBalance and PrincipalBalance.
    
		![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/f1c4c7a7-8b71-4269-b96a-6241c83c3fc7)

		 -   AppiledAmount, Amount, MonthlyPayment, PrincipalBalance are highly correlated
		-  Amount, PrincipalPaymentsMade are highly correlated
		- PreviousRepaymentsBeforeLoan is correlated with AmountOfPreviousLoansBeforeLoan
	- Other observations that were made
		- Defaulted loans are high irrespective of gender.
		- Defaulted loans of the customers with no prior history in Bondora are high and Status of default and non default loans are almost equal for customers with prior credit history in Bondora.
		- Defaulted loans of Estonians are less than Non defaulted ones. While all others have Default loans are high.
	- After this EDA we get clear understanding of all the features of the dataset.


## Feature Engineering

* Label encoding of categorical variables. 
* **Mutual Information scores** were calculated for each and every column.
* *Initial MI scores*
![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/8c6a1662-ac2c-4c57-bc75-0b3329d2c23c)

* Outliers were handled by replacing them with the median values. \
* Standardization and normalization were performed in order to scale values. Any of them can be used.
* Top features with high MI Scores were selected as important features. 
`feature_cols = ['InterestAndPenaltyBalance', 'PrincipalPaymentDifference',
       'PrincipalPaymentsMade', 'PrincipalBalance',
       'InterestAndPenaltyPaymentsMade', 'Interest', 'MonthlyPayment',
       'Amount', 'AppliedAmount', 'LanguageCode', 'Rating', 'Country','Restructured','LoanDuration','MonthlyPaymentDay']`
* Principal component analysis was done and the number of components were observed as 3. After pca we find that the performance is not increasing, instead decreasing. So it is not taken into consideration.

![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/74c48a93-cf89-4b79-b278-e702703c54df)

![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/93c10788-6169-4444-ac78-e06c090dc96b)

* Final data with important features is saved into a csv file.

## Classification Modelling

It is the mathematical representation of the output of the training process. Our project comes under the category of classification, which is a supervised learning method, we have done modelling using two algorithms

* K-Nearest Neighbor(KNN) classifier
* XGBoost classifier Steps involved are:

1. Data Preparation (Already done)

2. Splitting the data

3. Choosing a classification model.

	* The above classification models for chosen for this task
4. Training the Model

5. Model Evaluation

	Using different metrics

	* Accuracy
	* Precision
	* Recall
	* F1 score
	* Area under the ROC Curve(AUC-ROC)
6. Model Validation

	* k-fold cross validation

**Using KNN Model**


![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/ae729020-b468-46ca-9e3f-9b564376d45f)


*Classification Report*:


![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/c51fafd4-be4d-4be3-a7c4-6580bb6e6d0a)


![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/131d27e1-9fb1-4014-ba29-9b25f3d5d3d8)


![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/77a44903-b614-41ed-a656-83369607cb94)


`We got the Area under ROC curve as 93.68`
`Accuracy-93.4%`


![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/9a13be58-3241-4d6b-bd7a-277c8aa5906a)


These are the accuracies we get after performing k-fold cross validation(k=10)

**Using XGBClassifier**


![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/cad05505-c478-49a2-997d-204a9daccfe5)

*Classification Report*:


![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/18e63c05-9da3-4cb9-83fa-98a1e4a87411)


![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/9576b300-8b94-419f-9a98-bee781fd9117)


![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/89906de4-3005-440b-b131-c3c69f276d9a)


`We got the Area under ROC curve as 96.32`
`Accuracy-96.07%` for testing dataset


![image](https://github.com/Sri-Nitya/Bondora_financial_risk_prediction/assets/78259972/a0f9dd2d-d009-4935-be77-ec7b6ca7b075)


These are the accuracies we get after performing k-fold cross validation(k=10)
* We observe XGBClassifier is performing better than KNNClassifier. Let's proceed with XGBClassifier for further deployment. 

## Regression Modelling
Three target variables are created 
- Preferred EMI(Equated Monthly Installment)
- Preferred ELA(Eligible Loan Amount)
- Preferred ROI(Return On Investment)

In Order to calculate EMI we use the formula
`emi = P x R x (1+R)^N / [(1+R)^N-1]`
where 
"P" is the principal loan amount,  
            "N" in tenure in months,  
            "R" is the prevailing interest rate.
 Loan Tenure is calculated from given MaturityDate and LoanDate
`data['LoanTenure'] = (data['MaturityDate'].dt.year - data['Loandate'].dt.year)*12+(data['MaturityDate'].dt.month - data['Loandate'].dt.month)`

To calculate ELA, the following were used
 * A: “AppliedAmount”  
 * R: “Interest”(Interest rate)  
 * N: “LoanTenure”  
 * I: “IncomeTotal”  
 * L: “LiabilitiesTotal”

For each row in the dataset:   
1. Calculate: Total Payment Due = `(A + (A*r) * n   `
2. Calculate: Max allowable amount = `(I – L) * 30% `  
3. If ( Total Payment Due <= Max allowable amount)   
Then ELA = TotalDue    
Else ELA = Max allowable amount

To calculate PROI, certain conditions were mentioned, those can be referred in the notebook. Before PROI, ROI is calculated as
`ROI = Net income/Cost of investment x100`
`data['InterestAmount'] = (data['Amount']*(data['Interest']/100))
data['TotalAmount'] = (data['InterestAmount'] + data['Amount'])` 
`data['ROI'] = (data['InterestAmount'] / data['TotalAmount'])*100`

After creating target variables, regression task was performed using 2 models
- Polynomial Regression 
- Lasso Regression
Polynomial regression was selected for further work as it is giving good R2 score values. 

## Pipelining
* Label Encoding to convert categorical variables into numerical variables. 
* Splitting of the data. 
* Classification pipelining
	```mermaid
	flowchart TD
	A(StandardScalar) --> B(PCA);
	B(PCA) --> C(XGBClassifier);
	```
* Regression pipelining
	```mermaid
	flowchart TD
	A(StandardScalar) --> B(PCA);
	B(PCA) --> C(PolynomialFeatures);
	C(PolynomialFeatures) --> D(LinearRegression)
	```
Two pickle files were saved for further deployment
## Deployment

* Initially a single page web application using html, css and flask with all the required features is created. The pipelined models were implemented and tested with new data. We found the app is working well giving good predictions for both classification and regression tasks.
* Then we have done deployment on render. 
* You can check the deployed web app [here](https://model-deployment-c4be.onrender.com). 
